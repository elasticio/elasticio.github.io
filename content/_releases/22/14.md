---
title: Product Update - v22.14
description: Details of the product update v22.14 from 7th of April 2022.
layout: rel
version: "22.14"
section: Product Updates
category: product-updates
releaseDate: 2022-04-07
redirect_from:
  - /releases/22.14.html
---

## Improvements and Updates

### Step designer: Sample data part

To provide a unified experience during the flow step design, we improved the Sample
data retrieval section. The look and feel is now more in line with our new
minimalist approach.

![Step designer: Sample Data part](/assets/img/RN/2214/step-designer-sample-data-initial.png)

The above images show the new Sample data retrieval view. The release {{page.version}}
add a new functionality, now you can skip the sample generation by clicking on
the **Skip Sample** button. The platform will add an empty JSON `{}` instead of
the Sample data.

When you retrieve the Sample the platform UI will show it only in JSON format. In
{{page.version}} version we removed the Integrator view of Data Sample.

![Step designer: Sample data retrieved](/assets/img/RN/2214/step-designer-sample-data-result.png)

Here you can view the Sample, collapse different sections of the JSON data
structure and edit it.

### Quota usage page improvements

To show the RAM quota overuse we improved the quota **Usage History** histogram.
If you go over the the set RAM quota value the overused part will show in red.

![Quota overuse](/assets/img/RN/2214/quota-page.png)

### SSH Keys and SSH 8.8

To support the newest SSH versions we deprecated the old `ssh-dss` signature and
we added `ssh-ed25519` instead. Now when you upload your SSH key to our platform
you will see the information about the supported signatures.

![SSH Key upload screen](/assets/img/RN/2214/ssh-signatures.png)

**Please Note** the old `ssh-rsa` keys are still supported. If you want to use
them you have two options:

1.  Use an OpenSSH `8.8+` client and generate your SSH Key using the `-oPubkeyAcceptedKeyTypes=+ssh-rsa` parameter. It will generate an `RSA+SHA-2` type SSH key which provides high level of security and works with the OpenSSH `8.8+` clients.
2.  Use an OpenSSH `<=8.7` client to generate your SSH Key.

### Flow deletion times

The platform {{page.version}} includes new capability to hard-delete the flows
after an **expiration time** set by the platform management. Every time you try to
delete the flow a warning message will show with the following text:

> Are you sure you want to delete "FLOW NAME" flow permanently? Deleting this
> flow is an irreversible process, we cannot undo a deletion if you complete
> the process by accident. Please note that the credentials linked with the flow
> will not be deleted.


{% if site.data.tenant.name == "elastic.io" %}

## HELM3

We constantly improve different aspects of HELM3 deployments in collaboration
with our partners. This section lists updates and improvements done in this round.


### Changes to `cadvisor` and `fluentd` demons

To enable better coexistence of platform microservices within the multi-service
Kubernetes clusters, we modified the logic used to run `cadvisor` and `fluentd` services.
The platform will run these services when the node has uniquely defined selectors.

To achieve this we introduced a new HELM3 configuration for the node labels for the
Kubernetes pod allocation.

```yaml
global:
  nodeSelectors:
    platform: "platform"
    longRunningTask: "longrunning"
    ordinaryTask: "ordinary"
```

For these changes to take affect we deprecate the following HELM3 configurations:

*   `KUBERNETES_ORDINARY_LABEL_VALUE`
*   `KUBERNETES_LONG_RUNNING_LABEL_VALUE`

These variables ware removed from the secrets HELM3 chart and are no longer used
by the `admiral` service starting from {{page.version}} release. Please use
`Values.global.nodeSelectors` platform HELM3 chart configuration instead.

The `cadvisor` pods will run on the nodes with the following labels:

*   `"elasticio-role": "{{Values.global.nodeSelectors.longRunningTask}}"`
*   `"elasticio-role": "{{Values.global.nodeSelectors.longRunningTask}}"`

The `fluentd` pods will run on the nodes with the following labels:

*   `"elasticio-role": "{{Values.global.nodeSelectors.platform}}"`
*   `"elasticio-role": "{{Values.global.nodeSelectors.longRunningTask}}"`
*   `"elasticio-role": "{{Values.global.nodeSelectors.longRunningTask}}"`

### Richer Ingress Management

Still TODO

To extend the Ingress setup capability we made changes in the `Handmaiden microservice`
to provide 2 new ways to provide annotations

config was introduced:

env var INGRESS_OPERATOR_ANNOTATIONS is introduced.
introduced new per tenant config (api docs https://api.elastic.io/docs/v2/#create-a-tenant):
"ingress_config": {
    "annotations": {
       "annotationName": "value"
    }
}
Helm configuration example:
global:
  services:
    handmaiden:
      annotations:
        kubernetes.io/ingress.class: 'nginx'
        testAnnotation: 'testValue'
Priority of annotation configuration (from low to high ):
defaultAnnotations -> annotations provided in the INGRESS_OPERATOR_ANNOTATIONS env var --> annotations, provided for the tenant using API --> static annotations which can not be overridden


### Flow deletion job

Introducing a new cron job called `clear-deleted-flows` which permanently deletes
flows from the MongoDB with the `DELETED` status. Every user trying to delete a
flow will see a [warning message](#flow-deletion-times) informing that this is a
permanent and irreversible action.

#### HELM3 optional variables

We introduce new environment variables which you can use to control the
`clear-deleted-flows` job:

*   `WIPER_CLEAR_DELETED_FLOWS_AGE_SECONDS` - Time in seconds the job must wait before deleting the flow permanently after it is marked as `DELETED` in the MongoDB. We set the default value to `86400` seconds (1 day).
*   `WIPER_CLEAR_DELETED_FLOWS_LIMIT` - Number of flows the `clear-deleted-flows` job will permanently delete each time it runs.

#### Release process

This release process applies if you already have a cluster running previous versions
of the platform code. **The {{page.number}} release will start an automatic migration.**

*   Backup the MongoDB data base before the deployment to have an opportunity to reverse the process.
*   Set `WIPER_CLEAR_DELETED_FLOWS_LIMIT` environment variables to `1000` or applicable number for your case to perform this operation faster.

> After the migration the `marathonevents`, `requestbins` and `taskstartlogs`
> deprecated collection will be removed.

### Iron Bank table creation on all Clickhouse instances



{% endif %}

## Fixed bugs



## Components
