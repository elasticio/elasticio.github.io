---
title: Product Update - v21.31
description: Details of the product update v21.31 from 7th of August 2021.
layout: rel
version: "21.31"
section: Product Updates
category: product-updates
releaseDate: 2021-08-07
---

## Features

### Regenerate Platform REST API Key

API and UI

### 2FA

Everything about 2fA and how to use it.

### Component Whitelisting

With the platform {{page.version}} version we introduce a new feature called **Component Whitelisting**.
In verbatim this means we can enable or disable certain integration components in
each contract based on the list of components - the Component Whitelist. If the
component whitelist is applied to a contract the following rules would apply:

*   You have access to all components available in your tenant while working in the developer (limited) workspaces.
*   You can only build integration flows using the available components (whitelisted components) in your production workspaces. Not included components would not show in your production workspaces while building an integration flow.
*   You can not export an integration flow from the developer workspace to production workspace if the flow contains a component not included in the whitelist.
*   You can not create a recipe with a contract level access when the recipe uses a component not included in the whitelisted components for the contract.
*   The developer workspace will not be converted to a production workspace in case when at least one step of one flow in your developer workspace uses not whitelisted component.

### Remove pending Contract invites

UI and API


## Improvements and Updates



{% if site.data.tenant.name == "elastic.io" %}

## HELM3

We are in middle of constantly improving various aspects of HELM3 deployments in
collaborations with our partners. These are updates and improvements done in
this round.

### Kubernetes Namespaces

With {{page.version}} release we remove Kubernetes namespace hard-coding from our
charts to integrate the platform into more Enterprise friendly infrastructures.

> **IMPORTANT** To deploy the platform version {{page.version}} on top of your existing cluster
> **you would need to re-create the entire kubernetes cluster**. We recommend to announce
> maintenance run since **the platform would be down for 10-15 minutes**.

Here are the steps necessary for a successful platform deployment:

1.  Delete existing namespaces OR uninstall helm release (**IMPORTANT: this step will delete the cluster**).
2.  Create following namespaces in kubernetes cluster (the `name` and `labels.name` should be equal to values provided in the `values.global.namespaces` of HELM3 charts):
```yaml
apiVersion: v1
kind: Namespace
metadata:
  labels:
    name: <monitoring_namespace_name_from_values>
  name: <monitoring_namespace_name_from_values>
---
apiVersion: v1
kind: Namespace
metadata:
  labels:
    name: <platform_namespace_name_from_values>
  name: <platform_namespace_name_from_values>
---
apiVersion: v1
kind: Namespace
metadata:
  labels:
    name: <tasks_namespace_name_from_values>
  name: <tasks_namespace_name_from_values>
```
The labels are important to platform's network functionality.
3.  Install the helm release.

### Support AWS Network Load Balancer for ingress LoadBalancer

### Make namespaces creation optional in helm3

### Helm: re-deploy service if config-map or secret was changed

### Support HTTPS for docker registry URI

## OEM Related

News in this section are for our customers who use
[OEM version of the elastic.io platform](https://www.elastic.io/saas-embedded-integration/).

### ClickHouse replication instructions

To facilitate installation of ClickHouse and the required dependencies to run in
the High Availability mode we added the following documentation pages:

*   [ClickHouse Installation](https://on-prem.elastic.io/installation/clickhouse-installation)
*   [Zookeeper Installation](https://on-prem.elastic.io/installation/zookeeper-installation)
*   [HAProxy Installation](https://on-prem.elastic.io/installation/haproxy-installation)

### Enabling Component Whitelisting

The newly introduced [Component Whitelisting](#component-whitelisting) feature
includes changes and parameters only accessible to the tenant administration. Before
you can use the component whitelisting you must enable a dedicated tenant level
parameter (switch) `attributes.feature_flags.contract_component_whitelist`. Set it to `true`
using a `PATCH` to `/v2/tenants/{TENANT_ID}` record (admin access).

TODO: How to set component white list?


### 2FA Enabling

Instruction on how to enable and clear 2fA setup for user.

{% endif %}

## Fixed Bugs

*   Impossible to join the Contract via invitation letter in case login with OIDC
*   Invalid '0' value in the required fields with type 'number'
*   Maester's Redis leaves incomplete object keys and Maester thinks it's OK.

## Components

### [Splitter component](/components/splitter/) `1.2.0`

*   **ADDED** ability to pass data from the individual messages to re-assembled message

### [CSV component](/components/csv/) `3.0.0`

*   **ADDED** new actions:
    - `Read CSV attachment`
    - `Create CSV From Message Stream`
    - `Create CSV From JSON Array`

*   **DELETED** trigger and actions:

      - `Read CSV attachment` trigger
      - `Write CSV attachment`
      - `Write CSV attachment from JSON Array`
      - `Write CSV attachment from JSON Object`
      - `Read CSV file from URL`

### [id-linking-component](/components/id-linking/) `1.0.1`

*   **UPDATED** to sailor version `2.6.26`
*   **UPDATED** to Maester client library version `3.0.0`

### [Delta Detection Component](/components/delta-detection/) `2.0.3`

*   **UPDATED** to Maester client library version `3.0.0`

### [Google PubSub component](/components/google-pubsub/) `1.7.3`

*   **FIXED** the bug with not-awaited emits and endless cycle

### [Maester component](/components/maester-component/) `1.0.0`
*   **ADDED** new actions:

  - `Delete Object`
  - `Lookup Object (at most one)`
  - `Lookup Objects`
  - `Upsert Object`

### [Utility Component](/components/maester-component/) `1.3.0`
*   **ADDED** new action: `Delay`
*   **UPDATED**
- sailor version to 2.6.26
- buildType to docker
